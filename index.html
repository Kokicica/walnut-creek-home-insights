<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walnut Creek Home Insights</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: "Inter", sans-serif;
            scroll-behavior: smooth; /* Smooth scrolling for navigation links */
        }
        /* Custom styles for modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #fff;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .close-button {
            position: absolute;
            top: 1rem;
            right: 1.5rem;
            font-size: 2rem;
            cursor: pointer;
            color: #4a5568;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            gap: 0.5rem;
        }
        .step-indicator > div {
            flex-grow: 1;
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
        }
        .step-indicator > div.active {
            background-color: #2a9d8f;
        }
        .message-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #2a9d8f;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            z-index: 1001;
        }
        .message-box.show {
            opacity: 1;
        }
        /* Styles for ADU calculator specific elements within the modal-content */
        /* Reusing common modal-content, step-indicator, close-button for ADU calculator */
        #aduCalculatorModal .modal-content h2 { /* Targeting the main title within ADU modal */
            font-size: 2rem; /* Adjusted for overall consistency, original was 3xl */
            font-weight: bold;
            margin-bottom: 1.5rem; /* Adjusted from 6 for better spacing */
            text-align: center;
            color: #2a9d8f; /* Primary green color */
        }
        #aduCalculatorModal .modal-content label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.95rem; /* Slightly smaller than main page labels but larger than small for forms */
        }
        #aduCalculatorModal .modal-content input[type="number"],
        #aduCalculatorModal .modal-content select {
            width: 100%;
            padding: 0.75rem; /* Adjusted for modals */
            border: 1px solid #cbd5e0;
            border-radius: 0.5rem; /* 8px rounded */
            background-color: #edf2f7;
            color: #4a5568;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z' fill='%232d3748'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.7em top 50%;
            background-size: 0.65em auto;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        #aduCalculatorModal .modal-content input[type="number"]:focus,
        #aduCalculatorModal .modal-content select:focus {
            outline: none;
            border-color: #2a9d8f; /* Focus color */
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.2); /* Focus ring */
        }
        #aduCalculatorModal .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem; /* 12px */
            margin-top: 0.5rem;
            margin-bottom: 1rem;
        }
        #aduCalculatorModal .checkbox-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 0.625rem 0.875rem; /* 10px 14px */
            border: 1px solid #cbd5e0;
            border-radius: 0.5rem; /* 8px */
            background-color: #f7fafc;
            transition: all 0.2s ease-in-out;
            color: #4a5568;
            font-weight: normal; /* Override more specific inter styles for checkboxes */
        }
        #aduCalculatorModal .checkbox-group input[type="checkbox"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 1.125rem; /* 18px */
            height: 1.125rem; /* 18px */
            border: 2px solid #a0aec0;
            border-radius: 0.25rem; /* 4px */
            cursor: pointer;
            display: inline-block;
            position: relative;
            vertical-align: middle;
            flex-shrink: 0;
            margin-right: 0.5rem; /* 8px */
        }
        #aduCalculatorModal .checkbox-group input[type="checkbox"]:checked {
            background-color: #2a9d8f; /* Green on checked */
            border-color: #2a9d8f;
        }
        #aduCalculatorModal .checkbox-group input[type="checkbox"]:checked::after {
            content: 'âœ“';
            color: white;
            font-size: 0.75rem; /* 12px */
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        #aduCalculatorModal .checkbox-group label:hover {
            background-color: #ebf8f7; /* Lighter green-tinted on hover */
            border-color: #8ab17d;
        }

        #aduCalculatorModal .results-section {
            background-color: #e6f6f5; /* Light green background for results */
            border-radius: 0.75rem; /* 12px */
            padding: 1.5rem; /* 24px */
            margin-top: 2rem; /* 32px */
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.05);
        }
        #aduCalculatorModal .results-section h2 {
            color: #2a9d8f; /* Darker green for results heading */
            font-size: 1.5rem; /* 2xl */
            margin-bottom: 1rem;
            text-align: center;
        }
        #aduCalculatorModal .results-section .cost-display {
            font-size: 2.25rem; /* 3xl */
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
            color: #2a9d8f;
        }
        #aduCalculatorModal .results-section ul {
            list-style: none;
            padding-left: 0;
        }
        #aduCalculatorModal .results-section li {
            margin-bottom: 0.5rem;
            color: #4a5568;
            font-size: 0.95rem;
        }
        #aduCalculatorModal .results-section li strong {
            color: #2d3748;
        }
        #aduCalculatorModal .disclaimer {
            font-size: 0.875rem;
            color: #718096;
            margin-top: 1.25rem;
            text-align: center;
        }
        #aduCalculatorModal .calculate-button {
            background-color: #f4a261; /* Orange button */
            color: white;
            padding: 0.875rem 1.5rem; /* 14px 24px */
            border: none;
            border-radius: 0.5rem; /* 8px */
            font-size: 1.125rem; /* Larger font */
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(244, 162, 97, 0.3);
            width: 100%;
            margin-top: 1.5rem;
        }
        #aduCalculatorModal .calculate-button:hover {
            background-color: #e08c50; /* Darker orange on hover */
            transform: translateY(-2px);
        }
        .form-section-title { /* For general calculator section titles within modals */
            font-size: 1.25rem; /* xl */
            font-weight: 600;
            color: #2a9d8f;
            margin-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Section 1: Fixed Header -->
    <header class="fixed top-0 left-0 w-full bg-white shadow-md z-50 p-4">
        <nav class="container mx-auto flex items-center justify-between flex-wrap">
            <div class="flex items-center flex-shrink-0 text-gray-800 mr-6">
                <i class="fas fa-home text-[#2a9d8f] text-2xl mr-2"></i>
                <span class="font-bold text-xl tracking-tight">WALNUT CREEK HOME INSIGHTS</span>
            </div>
            <div class="block lg:hidden">
                <button id="nav-toggle" class="flex items-center px-3 py-2 border rounded text-gray-500 border-gray-600 hover:text-gray-800 hover:border-gray-800">
                    <svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v15z"/></svg>
                </button>
            </div>
            <div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto hidden" id="nav-content">
                <div class="text-sm lg:flex-grow">
                    <a href="#calculator-hub" class="block mt-4 lg:inline-block lg:mt-0 text-gray-700 hover:text-[#2a9d8f] mr-6">CALCULATORS</a>
                    <a href="#how-it-works" class="block mt-4 lg:inline-block lg:mt-0 text-gray-700 hover:text-[#2a9d8f] mr-6">HOW IT WORKS</a>
                    <a href="#partners" class="block mt-4 lg:inline-block lg:mt-0 text-gray-700 hover:text-[#2a9d8f]">PARTNERS</a>
                </div>
                <div>
                    <a href="https://bayareapanels.com" target="_blank" class="inline-block text-sm px-5 py-2 leading-none border border-[#f4a261] rounded-xl text-white bg-[#f4a261] hover:bg-orange-600 hover:border-orange-600 transition duration-300 transform hover:scale-105 mt-4 lg:mt-0 shadow-md">
                        Electrical Help? Visit Bay Area Panels
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Section 2: Hero Section -->
    <section class="relative h-[60vh] md:h-[75vh] flex items-center justify-center text-center text-white overflow-hidden pt-16">
        <div class="absolute inset-0 bg-[url('https://placehold.co/1200x800/2a9d8f/ffffff?text=Walnut+Creek+Luxury+Home')] bg-cover bg-center"></div>
        <div class="absolute inset-0 bg-black opacity-50"></div>
        <div class="relative z-10 p-4 md:p-8">
            <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mb-4 drop-shadow-lg">Plan Your Walnut Creek Home Project Like a Pro</h1>
            <p class="text-lg md:text-2xl mb-8 drop-shadow-md">Free local cost estimates for renovations, upgrades & repairs in Walnut Creek.</p>
            <a href="#calculator-hub" class="inline-block bg-[#f4a261] text-white py-4 px-8 rounded-xl text-xl font-semibold shadow-lg hover:bg-orange-600 transition duration-300 transform hover:scale-105">
                Explore Our 3 Free Tools
            </a>
            <p class="text-sm md:text-base mt-6 opacity-80">Trusted by Walnut Creek Homeowners</p>
        </div>
    </section>

    <!-- Section 3: Calculator Hub -->
    <section id="calculator-hub" class="py-16 md:py-24 bg-gray-100">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bold text-center mb-4 text-gray-800">Your Walnut Creek Project Calculators</h2>
            <p class="text-xl text-center text-gray-600 mb-12">Get instant estimates &rarr; connect with vetted local experts</p>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

                <!-- Electrical Health Calculator Card -->
                <div class="calculator-card p-6 bg-[#8ab17d] text-white rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 transform hover:scale-[1.03] cursor-pointer" data-calculator="electrical">
                    <i class="fas fa-bolt text-5xl mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Electrical Health</h3>
                    <p class="text-lg mb-6">Know your panel risk.</p>
                    <button class="estimate-button bg-[#f4a261] text-white py-3 px-6 rounded-lg font-semibold shadow-md hover:bg-orange-600 transition duration-300">Estimate Project</button>
                </div>

                <!-- Kitchen Remodel Calculator Card -->
                <div class="calculator-card p-6 bg-[#8ab17d] text-white rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 transform hover:scale-[1.03] cursor-pointer" data-calculator="kitchen">
                    <i class="fas fa-utensils text-5xl mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Kitchen Remodel</h3>
                    <p class="text-lg mb-6">Budget your dream kitchen.</p>
                    <button class="estimate-button bg-[#f4a261] text-white py-3 px-6 rounded-lg font-semibold shadow-md hover:bg-orange-600 transition duration-300">Estimate Project</button>
                </div>

                <!-- Landscape Design Calculator Card -->
                <div class="calculator-card p-6 bg-[#8ab17d] text-white rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 transform hover:scale-[1.03] cursor-pointer" data-calculator="landscape">
                    <i class="fas fa-tree text-5xl mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Landscape Design</h3>
                    <p class="text-lg mb-6">Cost your outdoor oasis.</p>
                    <button class="estimate-button bg-[#f4a261] text-white py-3 px-6 rounded-lg font-semibold shadow-md hover:bg-orange-600 transition duration-300">Estimate Project</button>
                </div>

                <!-- NEW: ADU Expansion Calculator Card -->
                <div class="calculator-card p-6 bg-[#8ab17d] text-white rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 transform hover:scale-[1.03] cursor-pointer" data-calculator="adu">
                    <i class="fas fa-house-chimney-medical text-5xl mb-4"></i> <!-- Icon for ADU -->
                    <h3 class="text-2xl font-bold mb-2">ADU Expansion</h3>
                    <p class="text-lg mb-6">Estimate your ADU addition.</p>
                    <button class="estimate-button bg-[#f4a261] text-white py-3 px-6 rounded-lg font-semibold shadow-md hover:bg-orange-600 transition duration-300">Estimate Project</button>
                </div>

            </div>
        </div>
    </section>

    <!-- Section: How It Works -->
    <section id="how-it-works" class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-4xl font-bold mb-8 text-gray-800">How It Works</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <div class="p-6 rounded-xl shadow-md bg-gray-50">
                    <i class="fas fa-mouse-pointer text-5xl text-[#2a9d8f] mb-4"></i>
                    <h3 class="text-2xl font-semibold mb-2">1. Choose Your Calculator</h3>
                    <p class="text-gray-700">Select the home project you're planning from our specialized Walnut Creek tools.</p>
                </div>
                <div class="p-6 rounded-xl shadow-md bg-gray-50">
                    <i class="fas fa-keyboard text-5xl text-[#2a9d8f] mb-4"></i>
                    <h3 class="text-2xl font-semibold mb-2">2. Input Details</h3>
                    <p class="text-gray-700">Answer a few simple questions about your project for a personalized estimate.</p>
                </div>
                <div class="p-6 rounded-xl shadow-md bg-gray-50">
                    <i class="fas fa-handshake text-5xl text-[#2a9d8f] mb-4"></i>
                    <h3 class="text-2xl font-semibold mb-2">3. Get Estimate & Connect</h3>
                    <p class="text-gray-700">Receive an instant estimate and optional connection to vetted local Walnut Creek experts.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section: Partners -->
    <section id="partners" class="py-16 md:py-24 bg-gray-100">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-4xl font-bold mb-8 text-gray-800">Our Trusted Walnut Creek Partners</h2>
            <p class="text-xl text-gray-600 mb-12">We connect you with reliable professionals dedicated to quality service in Walnut Creek.</p>
            <div class="flex flex-wrap justify-center items-center gap-8">
                <!-- Placeholder for Bay Area Panels Logo -->
                <div class="p-4 bg-white rounded-lg shadow-md w-40 h-24 flex items-center justify-center">
                    <span class="text-gray-500 font-semibold text-center">Bay Area Panels Logo</span>
                </div>
                <!-- Placeholder for Walnut Creek Landscapes Logo -->
                <div class="p-4 bg-white rounded-lg shadow-md w-40 h-24 flex items-center justify-center">
                    <span class="text-gray-500 font-semibold text-center">Walnut Creek Landscapes Logo</span>
                </div>
                <!-- Placeholder for Walnut Creek Remodelers Logo -->
                <div class="p-4 bg-white rounded-lg shadow-md w-40 h-24 flex items-center justify-center">
                    <span class="text-gray-500 font-semibold text-center">Walnut Creek Remodelers Logo</span>
                </div>
                <!-- Add more partner logos as needed -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-[#2a9d8f] text-white py-8 text-center">
        <div class="container mx-auto px-4">
            <p>&copy; 2025 Walnut Creek Home Insights. All rights reserved.</p>
            <p class="text-sm mt-2">Estimates are for informational purposes only. Consult licensed professionals for exact quotes.</p>
        </div>
    </footer>

    <!-- Modals -->

    <!-- Electrical Health Calculator Modal -->
    <div id="electricalCalculatorModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button" data-modal="electrical">&times;</span>
            <div class="step-indicator">
                <div id="electricalStep1Indicator" class="active"></div>
                <div id="electricalStep2Indicator"></div>
                <div id="electricalStep3Indicator"></div>
            </div>
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Electrical Health Calculator</h2>

            <!-- Step 1: Inputs -->
            <div id="electricalStep1">
                <p class="mb-6 text-lg text-gray-600">Step 1 of 3: Tell us about your Walnut Creek home's electrical system.</p>
                <div class="mb-6"><label for="homeAge" class="block text-gray-700 text-sm font-semibold mb-2">Home Age</label><select id="homeAge" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="unknown">Select home age</option><option value="pre1950">Pre-1950</option><option value="1950-1980" selected>1950-1980</option><option value="1980-2000">1980-2000</option><option value="2000-present">2000-Present</option></select></div>
                <div class="mb-6"><label for="panelBrand" class="block text-gray-700 text-sm font-semibold mb-2">Main Electrical Panel Brand</label><select id="panelBrand" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="unknown">Select panel brand</option><option value="square-d">Square D</option><option value="ge">GE</option><option value="cutler-hammer">Cutler-Hammer</option><option value="federal-pacific">Federal Pacific (Stab-Lok)</option><option value="challenger">Challenger</option><option value="other">Other</option></select></div>
                <div class="mb-6"><label for="amperage" class="block text-gray-700 text-sm font-semibold mb-2">Current Amperage</label><select id="amperage" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="unknown">Select amperage</option><option value="60">60 Amp</option><option value="100" selected>100 Amp</option><option value="150">150 Amp</option><option value="200">200 Amp</option><option value="more-200">More than 200 Amp</option></select></div>
                <div class="mb-6"><label for="panelType" class="block text-gray-700 text-sm font-semibold mb-2">Panel Type</label><select id="panelType" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="breaker" selected>Breaker Panel</option><option value="fuse">Fuse Box</option></select></div>
                <div class="mb-6"><label class="block text-gray-700 text-sm font-semibold mb-2">Conditions & Future Plans</label><div class="flex items-center mb-3"><input type="checkbox" id="recentRemodels" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="recentRemodels" class="text-gray-800">Had recent major remodels (e.g., kitchen, ADU, EV charger)?</label></div><div class="flex items-center mb-3"><input type="checkbox" id="electricalIssues" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="electricalIssues" class="text-gray-800">Experiencing electrical issues (flickering, tripping breakers, burning smells)?</label></div></div>
                <div class="mb-6"><label class="block text-gray-700 text-sm font-semibold mb-2">Primary Reason for Using This Calculator?</label><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div class="flex items-center"><input type="checkbox" id="reasonCuriosity" name="reason" value="curiosity" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonCuriosity" class="text-gray-800">General Curiosity/Home Maintenance</label></div><div class="flex items-center"><input type="checkbox" id="reasonTripping" name="reason" value="tripping" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonTripping" class="text-gray-800">Frequent Tripping Breakers / Flickering Lights</label></div><div class="flex items-center"><input type="checkbox" id="reasonEV" name="reason" value="ev" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonEV" class="text-gray-800">Adding an EV Charger</label></div><div class="flex items-center"><input type="checkbox" id="reasonRemodel" name="reason" value="remodel" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonRemodel" class="text-gray-800">Planning a Major Remodel</label></div><div class="flex items-center"><input type="checkbox" id="reasonInspection" name="reason" value="inspection" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonInspection" class="text-gray-800">Home Inspection Recommendation</label></div><div class="flex items-center"><input type="checkbox" id="reasonSolar" name="reason" value="solar" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonSolar" class="text-gray-800">Considering Solar or Battery Storage</label></div><div class="flex items-center"><input type="checkbox" id="reasonSmells" name="reason" value="smells" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonSmells" class="text-gray-800">Burning Smells or Electrical Sounds</label></div><div class="flex items-center"><input type="checkbox" id="reasonOtherCheckbox" name="reason" value="other" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="reasonOtherCheckbox" class="text-gray-800">Other</label></div></div><textarea id="reasonOtherText" class="mt-3 w-full p-3 border border-gray-300 rounded-lg hidden focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" placeholder="Please specify your reason"></textarea></div>
                <div class="mb-6"><label class="block text-gray-700 text-sm font-semibold mb-2">What large electrical appliances or features do you have or plan to add?</label><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div class="flex items-center"><input type="checkbox" id="applianceAC" name="appliance" value="ac" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceAC" class="text-gray-800">Central Air Conditioning (AC)</label></div><div class="flex items-center"><input type="checkbox" id="applianceEV" name="appliance" value="ev" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceEV" class="text-gray-800">Electric Vehicle (EV)</label></div><div class="flex items-center"><input type="checkbox" id="applianceWaterHeater" name="appliance" value="water-heater" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceWaterHeater" class="text-gray-800">Electric Water Heater</label></div><div class="flex items-center"><input type="checkbox" id="applianceRange" name="appliance" value="range" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceRange" class="text-gray-800">Electric Range/Stove</label></div><div class="flex items-center"><input type="checkbox" id="applianceDryer" name="appliance" value="dryer" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceDryer" class="text-gray-800">Electric Clothes Dryer</label></div><div class="flex items-center"><input type="checkbox" id="applianceHotTub" name="appliance" value="hot-tub" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceHotTub" class="text-gray-800">Hot Tub / Spa</label></div><div class="flex items-center"><input type="checkbox" id="applianceSolarExisting" name="appliance" value="solar-existing" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="applianceSolarExisting" class="text-gray-800">Existing Solar Panels</label></div></div></div>
                <div class="mb-6"><label class="block text-gray-700 text-sm font-semibold mb-2">Are you interested in a free, no-obligation electrical inspection or quote from Bay Area Panels?</label><div class="flex items-center mb-2"><input type="radio" id="interestYes" name="interestLevel" value="yes" class="h-5 w-5 text-[#2a9d8f] focus:ring-[#2a9d8f] mr-3"><label for="interestYes" class="text-gray-800">Yes, please contact me for a free inspection/quote.</label></div><div class="flex items-center"><input type="radio" id="interestNo" name="interestLevel" value="no" class="h-5 w-5 text-[#2a9d8f] focus:ring-[#2a9d8f] mr-3"><label for="interestNo" class="text-gray-800">No, I'm just looking for an estimate for now.</label></div></div>
                <button id="calculateElectricalButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Calculate</button>
            </div>

            <!-- Step 2: Results -->
            <div id="electricalStep2" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 2 of 3: Your estimated results.</p>
                <h3 id="electricalResultsHeadline" class="text-2xl font-bold mb-4 text-gray-800"></h3>
                <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                    <li id="electricalKeyFinding"></li>
                    <li id="electricalCostTimeline"></li>
                    <li id="electricalWalnutCreekTip"></li>
                </ul>
                <p class="text-sm text-gray-500 mb-8">Estimates use aggregated Walnut Creek electrical project data. For an exact, binding quote and a thorough safety assessment, please consult Bay Area Panels directly.</p>
                <button id="getElectricalQuoteButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Get a Free Quote</button>
            </div>

            <!-- Step 3: Lead Capture -->
            <div id="electricalStep3" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 3 of 3: Connect with local experts.</p>
                <h3 class="text-2xl font-bold mb-6 text-gray-800">Get a Free Electrical Inspection & Custom Quote from Bay Area Panels</h3>
                <form id="electricalLeadCaptureForm" action="https://formspree.io/f/mblypaer" method="POST">
                    <div class="mb-4"><label for="electricalFullName" class="block text-gray-700 text-sm font-semibold mb-2">Full Name <span class="text-red-500">*</span></label><input type="text" id="electricalFullName" name="fullName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="electricalEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email <span class="text-red-500">*</span></label><input type="email" id="electricalEmail" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="electricalPhone" class="block text-gray-700 text-sm font-semibold mb-2">Phone <span class="text-red-500">*</span></label><input type="tel" id="electricalPhone" name="phone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-6"><label for="electricalAddress" class="block text-gray-700 text-sm font-semibold mb-2">Walnut Creek Project Address <span class="text-red-500">*</span></label><input type="text" id="electricalAddress" name="address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-6 flex items-start"><input type="checkbox" id="sendToBayAreaPanels" name="sendToBayAreaPanels" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3 mt-1" checked disabled><label for="sendToBayAreaPanels" class="text-gray-800 font-medium">Yes, please send my details to Bay Area Panels to schedule my free inspection/quote.</label></div>
                    <input type="hidden" name="calculatorUsed" value="Electrical Health">
                    <input type="hidden" name="estimatedResult" id="electricalEstimatedResult">
                    <button type="submit" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Connect Me with Bay Area Panels &rarr;</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Kitchen Remodel Calculator Modal -->
    <div id="kitchenCalculatorModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button" data-modal="kitchen">&times;</span>
            <div class="step-indicator">
                <div id="kitchenStep1Indicator" class="active"></div>
                <div id="kitchenStep2Indicator"></div>
                <div id="kitchenStep3Indicator"></div>
            </div>
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Kitchen Remodel Calculator</h2>

            <!-- Step 1: Inputs -->
            <div id="kitchenStep1">
                <p class="mb-6 text-lg text-gray-600">Step 1 of 3: Let's estimate your dream kitchen for Walnut Creek.</p>
                <div class="mb-6"><label for="kitchenSize" class="block text-gray-700 text-sm font-semibold mb-2">Kitchen Size</label><select id="kitchenSize" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="small">Small (under 100 sq ft)</option><option value="medium">Medium (100-250 sq ft)</option><option value="large">Large (over 250 sq ft)</option></select></div>
                <div class="mb-6"><label for="kitchenFinish" class="block text-gray-700 text-sm font-semibold mb-2">Finish Level</label><select id="kitchenFinish" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="basic">Basic (Refreshed)</option><option value="mid-range">Mid-Range (New Cabinets/Counters)</option><option value="luxury">Luxury (Custom, High-End)</option></select></div>
                <div class="mb-6"><label for="countertopMaterial" class="block text-gray-700 text-sm font-semibold mb-2">Countertop Material</label><select id="countertopMaterial" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="laminate">Laminate</option><option value="quartz-granite">Quartz/Granite</option><option value="marble">Marble/High-End Stone</option></select></div>
                <div class="mb-6"><label for="newAppliances" class="block text-gray-700 text-sm font-semibold mb-2">New Appliances?</label><select id="newAppliances" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="no">No, keeping existing</option><option value="mid-range">Yes, mid-range appliances</option><option value="high-end">Yes, high-end appliances</option></select></div>
                <button id="calculateKitchenButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Calculate</button>
            </div>

            <!-- Step 2: Results -->
            <div id="kitchenStep2" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 2 of 3: Your estimated results.</p>
                <h3 id="kitchenResultsHeadline" class="text-2xl font-bold mb-4 text-gray-800"></h3>
                <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                    <li id="kitchenKeyFinding"></li>
                    <li id="kitchenCostTimeline"></li>
                    <li id="kitchenWalnutCreekTip"></li>
                </ul>
                <p class="text-sm text-gray-500 mb-8">Estimates use aggregated Walnut Creek kitchen remodel data. Consult local remodelers for exact quotes.</p>
                <button id="getKitchenQuoteButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Get a Free Quote</button>
            </div>

            <!-- Step 3: Lead Capture -->
            <div id="kitchenStep3" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 3 of 3: Connect with local experts.</p>
                <h3 class="text-2xl font-bold mb-6 text-gray-800">Get a Free Quote from Walnut Creek Remodelers</h3>
                <form id="kitchenLeadCaptureForm" action="https://formspree.io/f/mblypaer" method="POST">
                    <div class="mb-4"><label for="kitchenFullName" class="block text-gray-700 text-sm font-semibold mb-2">Full Name <span class="text-red-500">*</span></label><input type="text" id="kitchenFullName" name="fullName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="kitchenEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email <span class="text-red-500">*</span></label><input type="email" id="kitchenEmail" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="kitchenPhone" class="block text-gray-700 text-sm font-semibold mb-2">Phone</label><input type="tel" id="kitchenPhone" name="phone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6"><label for="kitchenAddress" class="block text-gray-700 text-sm font-semibold mb-2">Walnut Creek Project Address</label><input type="text" id="kitchenAddress" name="address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6 flex items-start"><input type="checkbox" id="kitchenSendToBayAreaPanels" name="sendToBayAreaPanels" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3 mt-1"><label for="kitchenSendToBayAreaPanels" class="text-gray-800 font-medium">Also send my details to Bay Area Panels (for electrical upgrade needs).</label></div>
                    <input type="hidden" name="calculatorUsed" value="Kitchen Remodel">
                    <input type="hidden" name="estimatedResult" id="kitchenEstimatedResult">
                    <button type="submit" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Connect Me with Experts &rarr;</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Landscape Design Calculator Modal -->
    <div id="landscapeCalculatorModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button" data-modal="landscape">&times;</span>
            <div class="step-indicator">
                <div id="landscapeStep1Indicator" class="active"></div>
                <div id="landscapeStep2Indicator"></div>
                <div id="landscapeStep3Indicator"></div>
            </div>
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Landscape Design Calculator</h2>

            <!-- Step 1: Inputs -->
            <div id="landscapeStep1">
                <p class="mb-6 text-lg text-gray-600">Step 1 of 3: Visualize and cost your outdoor oasis for Walnut Creek.</p>
                <div class="mb-6"><label for="yardSize" class="block text-gray-700 text-sm font-semibold mb-2">Yard Size (sq ft)</label><input type="number" id="yardSize" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" value="1000"></div>
                <div class="mb-6"><label for="landscapeStyle" class="block text-gray-700 text-sm font-semibold mb-2">Desired Style</label><select id="landscapeStyle" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"><option value="modern">Modern/Minimalist</option><option value="drought-tolerant">Drought-Tolerant/Native</option><option value="traditional">Traditional/Lush</option></select></div>
                <div class="mb-6"><label class="block text-gray-700 text-sm font-semibold mb-2">Key Features</label><div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div class="flex items-center"><input type="checkbox" id="featurePatioDeck" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="featurePatioDeck" class="text-gray-800">New Patio/Deck</label></div><div class="flex items-center"><input type="checkbox" id="featureOutdoorLighting" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="featureOutdoorLighting" class="text-gray-800">Outdoor Lighting</label></div><div class="flex items-center"><input type="checkbox" id="featureIrrigation" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="featureIrrigation" class="text-gray-800">Smart Irrigation System</label></div><div class="flex items-center"><input type="checkbox" id="featureOutdoorKitchen" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3"><label for="featureOutdoorKitchen" class="text-gray-800">Outdoor Kitchen/BBQ</label></div></div></div>
                <button id="calculateLandscapeButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Calculate</button>
            </div>

            <!-- Step 2: Results -->
            <div id="landscapeStep2" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 2 of 3: Your estimated results.</p>
                <h3 id="landscapeResultsHeadline" class="text-2xl font-bold mb-4 text-gray-800"></h3>
                <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                    <li id="landscapeKeyFinding"></li>
                    <li id="landscapeCostTimeline"></li>
                    <li id="landscapeWalnutCreekTip"></li>
                </ul>
                <p class="text-sm text-gray-500 mb-8">Estimates use aggregated Walnut Creek landscaping data. Consult local landscapers for exact quotes.</p>
                <button id="getLandscapeQuoteButton" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Get a Free Quote</button>
            </div>

            <!-- Step 3: Lead Capture -->
            <div id="landscapeStep3" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 3 of 3: Connect with local experts.</p>
                <h3 class="text-2xl font-bold mb-6 text-gray-800">Get a Free Quote from Walnut Creek Landscapers</h3>
                <form id="landscapeLeadCaptureForm" action="https://formspree.io/f/mblypaer" method="POST">
                    <div class="mb-4"><label for="landscapeFullName" class="block text-gray-700 text-sm font-semibold mb-2">Full Name <span class="text-red-500">*</span></label><input type="text" id="landscapeFullName" name="fullName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="landscapeEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email <span class="text-red-500">*</span></label><input type="email" id="landscapeEmail" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="landscapePhone" class="block text-gray-700 text-sm font-semibold mb-2">Phone</label><input type="tel" id="landscapePhone" name="phone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6"><label for="landscapeAddress" class="block text-gray-700 text-sm font-semibold mb-2">Walnut Creek Project Address</label><input type="text" id="landscapeAddress" name="address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6 flex items-start"><input type="checkbox" id="landscapeSendToBayAreaPanels" name="sendToBayAreaPanels" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3 mt-1"><label for="landscapeSendToBayAreaPanels" class="text-gray-800 font-medium">Also send my details to Bay Area Panels (for outdoor lighting electrical needs).</label></div>
                    <input type="hidden" name="calculatorUsed" value="Landscape Design">
                    <input type="hidden" name="estimatedResult" id="landscapeEstimatedResult">
                    <button type="submit" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Connect Me with Experts &rarr;</button>
                </form>
            </div>
        </div>
    </div>

    <!-- NEW: ADU Expansion Calculator Modal -->
    <div id="aduCalculatorModal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-button" data-modal="adu">&times;</span>
            <div class="step-indicator">
                <div id="aduStep1Indicator" class="active"></div>
                <!-- Although it's one step, keeping indicator for consistency -->
            </div>
            <h2 class="text-3xl font-bold mb-6 text-gray-800">ADU Expansion Cost Calculator</h2>

            <!-- ADU Calculator Inputs -->
            <div id="aduStep1">
                <p class="mb-6 text-lg text-gray-600">Estimate the cost of expanding your Accessory Dwelling Unit in the Bay Area.</p>

                <div class="mb-6">
                    <label for="aduType" class="block">Current ADU Type:</label>
                    <select id="aduType" class="w-full">
                        <option value="Attached Addition">Attached Addition</option>
                        <option value="Garage Conversion">Garage Conversion (Existing foundation/walls may reduce cost)</option>
                        <option value="Junior ADU">Junior ADU (Expansion of JADU within existing footprint)</option>
                        <option value="Detached ADU">Detached ADU (New detached structure expansion)</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label for="squareFootage" class="block">Square Footage of New Rooms Being Added:</label>
                    <input type="number" id="squareFootage" min="50" max="1000" value="300" placeholder="e.g., 300" class="w-full">
                </div>

                <div class="mb-6">
                    <label for="finishLevel" class="block">Desired Finish Level:</label>
                    <select id="finishLevel" class="w-full">
                        <option value="Basic">Basic (Standard materials, functional)</option>
                        <option value="Mid-Range">Mid-Range (Good quality materials, some custom touches)</option>
                        <option value="High-End">High-End (Premium materials, custom designs, luxury finishes)</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label class="block mb-2">Site Challenges:</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="aduSiteChallenges" value="Sloped Lot">
                            <span>Sloped Lot</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduSiteChallenges" value="Limited Access">
                            <span>Limited Access</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduSiteChallenges" value="Extensive Utility Runs">
                            <span>Extensive Utility Runs</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduSiteChallenges" value="Drainage Issues">
                            <span>Drainage Issues</span>
                        </label>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block mb-2">Additional Features:</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="aduAdditionalFeatures" value="Extra Bathroom">
                            <span>Extra Bathroom</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduAdditionalFeatures" value="Laundry">
                            <span>Laundry Hookups/Area</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduAdditionalFeatures" value="Deck/Patio">
                            <span>Deck/Patio</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduAdditionalFeatures" value="Solar Panels">
                            <span>Solar Panels (for new ADU space)</span>
                        </label>
                        <label>
                            <input type="checkbox" name="aduAdditionalFeatures" value="HighEfficiencyHVAC">
                            <span>High-Efficiency HVAC</span>
                        </label>
                    </div>
                </div>

                <button id="calculateAduCostBtn" class="calculate-button">Calculate Estimated Cost</button>
            </div>

            <!-- Results Section for ADU Calculator - Initially hidden -->
            <div id="aduResults" class="results-section hidden">
                <h2 class="results-section-title">Estimated ADU Expansion Costs:</h2>
                <div id="aduCostRange" class="cost-display">$0 - $0</div>
                <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                    <li><strong>Average Price Per Square Foot (Added Space):</strong> <span id="aduAvgPriceSqFt">$0</span></li>
                    <li><strong>Estimated Construction Timeline:</strong> <span id="aduTimeline">8-20 weeks</span></li>
                    <li><strong>Estimated Permit & Soft Costs:</strong> <span id="aduPermitSoftCosts">$0 - $0</span></li>
                </ul>
                <h3 class="form-section-title mt-6 mb-2">Helpful Tip for Walnut Creek ADU Expansions:</h3>
                <p id="aduWalnutCreekTip" class="disclaimer">
                    In Walnut Creek, ADU expansions are subject to specific zoning and building codes. Always check the latest regulations on the City of Walnut Creek Planning Department website. Consulting with local contractors and architects who specialize in ADUs in the Bay Area is highly recommended for accurate bids and to navigate local permitting processes efficiently. Be aware of potential impact fees and specific setback requirements for additions.
                </p>
                <p class="disclaimer mt-6">
                    <strong>Disclaimer:</strong> This calculator provides an *estimate* based on typical Bay Area construction costs and common factors. Actual costs can vary significantly due to specific site conditions, material fluctuations, contractor bids, and unforeseen issues. Always obtain multiple detailed bids from licensed local contractors.
                </p>
            </div>
            <!-- ADU Lead Capture Form -->
            <div id="aduStep2" class="hidden">
                <p class="mb-6 text-lg text-gray-600">Step 2 of 2: Connect with local experts.</p>
                <h3 class="text-2xl font-bold mb-6 text-gray-800">Get a Free ADU Expansion Quote</h3>
                <form id="aduLeadCaptureForm" action="https://formspree.io/f/mblypaer" method="POST">
                    <div class="mb-4"><label for="aduFullName" class="block text-gray-700 text-sm font-semibold mb-2">Full Name <span class="text-red-500">*</span></label><input type="text" id="aduFullName" name="fullName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="aduEmail" class="block text-gray-700 text-sm font-semibold mb-2">Email <span class="text-red-500">*</span></label><input type="email" id="aduEmail" name="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent" required></div>
                    <div class="mb-4"><label for="aduPhone" class="block text-gray-700 text-sm font-semibold mb-2">Phone</label><input type="tel" id="aduPhone" name="phone" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6"><label for="aduAddress" class="block text-gray-700 text-sm font-semibold mb-2">Walnut Creek Project Address</label><input type="text" id="aduAddress" name="address" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#2a9d8f] focus:border-transparent"></div>
                    <div class="mb-6 flex items-start"><input type="checkbox" id="aduSendToExperts" name="sendToExperts" class="h-5 w-5 text-[#2a9d8f] rounded focus:ring-[#2a9d8f] mr-3 mt-1" checked><label for="aduSendToExperts" class="text-gray-800 font-medium">Yes, please send my details to local ADU experts for a free quote.</label></div>
                    <input type="hidden" name="calculatorUsed" value="ADU Expansion">
                    <input type="hidden" name="estimatedResult" id="aduEstimatedResult">
                    <button type="submit" class="w-full bg-[#f4a261] text-white py-3 rounded-lg shadow-md hover:bg-orange-600 transition duration-300">Connect Me with Experts &rarr;</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Floating Message Box -->
    <div id="messageBox" class="message-box"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Mobile Nav Toggle
            const navToggle = document.getElementById('nav-toggle');
            const navContent = document.getElementById('nav-content');
            navToggle.addEventListener('click', () => {
                navContent.classList.toggle('hidden');
            });
            // Smooth scroll for nav links (hide nav on mobile after click)
            document.querySelectorAll('#nav-content a').forEach(link => {
                link.addEventListener('click', () => {
                    if (!navContent.classList.contains('hidden')) {
                        navContent.classList.add('hidden');
                    }
                });
            });


            // --- General Modal Handling ---
            const calculatorCards = document.querySelectorAll('.calculator-card');
            const modals = {
                electrical: document.getElementById('electricalCalculatorModal'),
                kitchen: document.getElementById('kitchenCalculatorModal'),
                landscape: document.getElementById('landscapeCalculatorModal'),
                adu: document.getElementById('aduCalculatorModal') // Add ADU modal to tracking
            };

            const closeButtons = document.querySelectorAll('.modal-content .close-button');
            const messageBox = document.getElementById('messageBox');

            let currentOpenModal = null; // Track which modal is currently open

            function showMessage(message) {
                messageBox.textContent = message;
                messageBox.classList.add('show');
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, 3000);
            }

            // Open Modal
            calculatorCards.forEach(card => {
                card.addEventListener('click', (e) => {
                    const calculatorType = card.dataset.calculator;
                    currentOpenModal = modals[calculatorType];
                    currentOpenModal.classList.add('show');
                    resetCalculatorState(calculatorType); // Reset specific calculator's state
                });
            });

            // Close Modal
            closeButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const calculatorType = button.dataset.modal;
                    modals[calculatorType].classList.remove('show');
                    currentOpenModal = null;
                });
            });

            // Close modal on outside click
            Object.values(modals).forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('show');
                        currentOpenModal = null;
                    }
                });
            });

            // --- Calculator-specific Logic ---

            // Electrical Calculator Elements
            const electricalStep1 = document.getElementById('electricalStep1');
            const electricalStep2 = document.getElementById('electricalStep2');
            const electricalStep3 = document.getElementById('electricalStep3');
            const electricalStep1Indicator = document.getElementById('electricalStep1Indicator');
            const electricalStep2Indicator = document.getElementById('electricalStep2Indicator');
            const electricalStep3Indicator = document.getElementById('electricalStep3Indicator');
            const calculateElectricalButton = document.getElementById('calculateElectricalButton');
            const getElectricalQuoteButton = document.getElementById('getElectricalQuoteButton');
            const electricalLeadCaptureForm = document.getElementById('electricalLeadCaptureForm');
            const electricalResultsHeadline = document.getElementById('electricalResultsHeadline');
            const electricalKeyFinding = document.getElementById('electricalKeyFinding');
            const electricalCostTimeline = document.getElementById('electricalCostTimeline');
            const electricalWalnutCreekTip = document.getElementById('electricalWalnutCreekTip');
            const electricalEstimatedResultHidden = document.getElementById('electricalEstimatedResult'); // Hidden input for result

            const electricalHomeAge = document.getElementById('homeAge');
            const electricalPanelBrand = document.getElementById('panelBrand');
            const electricalAmperage = document.getElementById('amperage');
            const electricalPanelType = document.getElementById('panelType');
            const electricalRecentRemodels = document.getElementById('recentRemodels');
            const electricalElectricalIssues = document.getElementById('electricalIssues');
            const electricalReasonOtherCheckbox = document.getElementById('reasonOtherCheckbox');
            const electricalReasonOtherText = document.getElementById('reasonOtherText');

            // Kitchen Calculator Elements
            const kitchenStep1 = document.getElementById('kitchenStep1');
            const kitchenStep2 = document.getElementById('kitchenStep2');
            const kitchenStep3 = document.getElementById('kitchenStep3');
            const kitchenStep1Indicator = document.getElementById('kitchenStep1Indicator');
            const kitchenStep2Indicator = document.getElementById('kitchenStep2Indicator');
            const kitchenStep3Indicator = document.getElementById('kitchenStep3Indicator');
            const calculateKitchenButton = document.getElementById('calculateKitchenButton');
            const getKitchenQuoteButton = document.getElementById('getKitchenQuoteButton');
            const kitchenLeadCaptureForm = document.getElementById('kitchenLeadCaptureForm');
            const kitchenResultsHeadline = document.getElementById('kitchenResultsHeadline');
            const kitchenKeyFinding = document.getElementById('kitchenKeyFinding');
            const kitchenCostTimeline = document.getElementById('kitchenCostTimeline');
            const kitchenWalnutCreekTip = document.getElementById('kitchenWalnutCreekTip');
            const kitchenEstimatedResultHidden = document.getElementById('kitchenEstimatedResult'); // Hidden input for result

            // Landscape Calculator Elements
            const landscapeStep1 = document.getElementById('landscapeStep1');
            const landscapeStep2 = document.getElementById('landscapeStep2');
            const landscapeStep3 = document.getElementById('landscapeStep3');
            const landscapeStep1Indicator = document.getElementById('landscapeStep1Indicator');
            const landscapeStep2Indicator = document.getElementById('landscapeStep2Indicator');
            const landscapeStep3Indicator = document.getElementById('landscapeStep3Indicator');
            const calculateLandscapeButton = document.getElementById('calculateLandscapeButton');
            const getLandscapeQuoteButton = document.getElementById('getLandscapeQuoteButton');
            const landscapeLeadCaptureForm = document.getElementById('landscapeLeadCaptureForm');
            const landscapeResultsHeadline = document.getElementById('landscapeResultsHeadline');
            const landscapeKeyFinding = document.getElementById('landscapeKeyFinding');
            const landscapeCostTimeline = document.getElementById('landscapeCostTimeline');
            const landscapeWalnutCreekTip = document.getElementById('landscapeWalnutCreekTip');
            const landscapeEstimatedResultHidden = document.getElementById('landscapeEstimatedResult'); // Hidden input for result

            // ADU Calculator Elements (NEW)
            const aduStep1 = document.getElementById('aduStep1');
            const aduStep2 = document.getElementById('aduStep2'); // ADU Lead Capture
            const aduStep1Indicator = document.getElementById('aduStep1Indicator');
            const aduStep2Indicator = document.getElementById('aduStep2Indicator'); // For ADU lead form step
            const aduTypeSelect = document.querySelector('#aduCalculatorModal #aduType');
            const squareFootageInput = document.querySelector('#aduCalculatorModal #squareFootage');
            const finishLevelSelect = document.querySelector('#aduCalculatorModal #finishLevel');
            const aduSiteChallengesCheckboxes = document.querySelectorAll('#aduCalculatorModal input[name="aduSiteChallenges"]');
            const aduAdditionalFeaturesCheckboxes = document.querySelectorAll('#aduCalculatorModal input[name="aduAdditionalFeatures"]');
            const calculateAduCostBtn = document.getElementById('calculateAduCostBtn');
            const aduResults = document.getElementById('aduResults');
            const aduCostRange = document.getElementById('aduCostRange');
            const aduAvgPriceSqFt = document.getElementById('aduAvgPriceSqFt');
            const aduTimeline = document.getElementById('aduTimeline');
            const aduPermitSoftCosts = document.getElementById('aduPermitSoftCosts');
            const aduLeadCaptureForm = document.getElementById('aduLeadCaptureForm'); // ADU Lead Capture Form
            const aduEstimatedResultHidden = document.getElementById('aduEstimatedResult'); // Hidden input for result


            // Function to manage step visibility for a given calculator
            function updateStepVisibility(calculatorType, stepNumber) {
                let s1, s2, s3, ind1, ind2, ind3;

                switch (calculatorType) {
                    case 'electrical':
                        s1 = electricalStep1; s2 = electricalStep2; s3 = electricalStep3;
                        ind1 = electricalStep1Indicator; ind2 = electricalStep2Indicator; ind3 = electricalStep3Indicator;
                        break;
                    case 'kitchen':
                        s1 = kitchenStep1; s2 = kitchenStep2; s3 = kitchenStep3;
                        ind1 = kitchenStep1Indicator; ind2 = kitchenStep2Indicator; ind3 = kitchenStep3Indicator;
                        break;
                    case 'landscape':
                        s1 = landscapeStep1; s2 = landscapeStep2; s3 = landscapeStep3;
                        ind1 = landscapeStep1Indicator; ind2 = landscapeStep2Indicator; ind3 = landscapeStep3Indicator;
                        break;
                    case 'adu':
                        s1 = aduStep1; s2 = aduStep2; s3 = null; // ADU has 2 steps (input + lead capture)
                        ind1 = aduStep1Indicator; ind2 = aduStep2Indicator; ind3 = null; // ADU has 2 indicators
                        break;
                }

                // Hide all steps first
                if (s1) s1.classList.add('hidden');
                if (s2) s2.classList.add('hidden');
                if (s3) s3.classList.add('hidden');

                // Deactivate all indicators first
                if (ind1) ind1.classList.remove('active');
                if (ind2) ind2.classList.remove('active');
                if (ind3) ind3.classList.remove('active');

                if (stepNumber === 1) {
                    s1.classList.remove('hidden');
                    if (ind1) ind1.classList.add('active');
                    // Ensure results are hidden when on step 1 (for ADU and others that display results after calc)
                    if (calculatorType === 'adu') {
                        aduResults.classList.add('hidden');
                    }
                } else if (stepNumber === 2) {
                    if (s2) s2.classList.remove('hidden');
                    if (ind1) ind1.classList.add('active');
                    if (ind2) ind2.classList.add('active');
                } else if (stepNumber === 3) {
                    if (s3) s3.classList.remove('hidden');
                    if (ind1) ind1.classList.add('active');
                    if (ind2) ind2.classList.add('active');
                    if (ind3) ind3.classList.add('active');
                }
            }

            // Function to reset a specific calculator's state
            function resetCalculatorState(calculatorType) {
                switch (calculatorType) {
                    case 'electrical':
                        electricalHomeAge.value = '1950-1980';
                        electricalPanelBrand.value = 'unknown';
                        electricalAmperage.value = '100';
                        electricalPanelType.value = 'breaker';
                        electricalRecentRemodels.checked = false;
                        electricalElectricalIssues.checked = false;
                        document.querySelectorAll('#electricalStep1 input[name="reason"]:checked').forEach(cb => cb.checked = false);
                        document.querySelectorAll('#electricalStep1 input[name="appliance"]:checked').forEach(cb => cb.checked = false);
                        document.querySelectorAll('#electricalStep1 input[name="interestLevel"]').forEach(radio => radio.checked = false);
                        electricalReasonOtherCheckbox.checked = false;
                        electricalReasonOtherText.classList.add('hidden');
                        electricalReasonOtherText.value = '';
                        electricalResultsHeadline.textContent = '';
                        electricalKeyFinding.textContent = '';
                        electricalCostTimeline.textContent = '';
                        electricalWalnutCreekTip.textContent = '';
                        electricalLeadCaptureForm.reset();
                        document.getElementById('sendToBayAreaPanels').checked = true; // Ensure always checked & disabled for electrical
                        break;
                    case 'kitchen':
                        document.getElementById('kitchenSize').value = 'small';
                        document.getElementById('kitchenFinish').value = 'basic';
                        document.getElementById('countertopMaterial').value = 'laminate';
                        document.getElementById('newAppliances').value = 'no';
                        kitchenResultsHeadline.textContent = '';
                        kitchenKeyFinding.textContent = '';
                        kitchenCostTimeline.textContent = '';
                        kitchenWalnutCreekTip.textContent = '';
                        kitchenLeadCaptureForm.reset();
                        document.getElementById('kitchenSendToBayAreaPanels').checked = false; // Ensure unchecked by default
                        break;
                    case 'landscape':
                        document.getElementById('yardSize').value = '1000';
                        document.getElementById('landscapeStyle').value = 'modern';
                        document.getElementById('featurePatioDeck').checked = false;
                        document.getElementById('featureOutdoorLighting').checked = false;
                        document.getElementById('featureIrrigation').checked = false;
                        document.getElementById('featureOutdoorKitchen').checked = false;
                        landscapeResultsHeadline.textContent = '';
                        landscapeKeyFinding.textContent = '';
                        landscapeCostTimeline.textContent = '';
                        landscapeWalnutCreekTip.textContent = '';
                        landscapeLeadCaptureForm.reset();
                        document.getElementById('landscapeSendToBayAreaPanels').checked = false; // Ensure unchecked by default
                        break;
                    case 'adu': // NEW ADU reset logic
                        aduTypeSelect.value = 'Attached Addition';
                        squareFootageInput.value = '300';
                        finishLevelSelect.value = 'Basic';
                        aduSiteChallengesCheckboxes.forEach(cb => cb.checked = false);
                        aduAdditionalFeaturesCheckboxes.forEach(cb => cb.checked = false);
                        aduResults.classList.add('hidden'); // Crucial: Hide results on reset
                        aduCostRange.textContent = '$0 - $0';
                        aduAvgPriceSqFt.textContent = '$0';
                        aduTimeline.textContent = '8-20 weeks';
                        aduPermitSoftCosts.textContent = '$0 - $0';
                        aduLeadCaptureForm.reset(); // Reset ADU lead form too
                        break;
                }
                updateStepVisibility(calculatorType, 1);
            }


            // --- ELECTRICAL CALCULATOR LOGIC ---
            electricalReasonOtherCheckbox.addEventListener('change', () => {
                if (electricalReasonOtherCheckbox.checked) {
                    electricalReasonOtherText.classList.remove('hidden');
                } else {
                    electricalReasonOtherText.classList.add('hidden');
                    electricalReasonOtherText.value = '';
                }
            });

            calculateElectricalButton.addEventListener('click', () => {
                const homeAge = electricalHomeAge.value;
                const panelBrand = electricalPanelBrand.value;
                const amperage = electricalAmperage.value;
                const panelType = electricalPanelType.value;
                const recentRemodels = electricalRecentRemodels.checked;
                const electricalIssues = electricalElectricalIssues.checked;

                const selectedReasons = Array.from(document.querySelectorAll('#electricalStep1 input[name="reason"]:checked'))
                                            .map(cb => cb.value === 'other' ? electricalReasonOtherText.value : cb.value);
                const selectedAppliances = Array.from(document.querySelectorAll('#electricalStep1 input[name="appliance"]:checked'))
                                                .map(cb => cb.value);
                const interestLevel = document.querySelector('#electricalStep1 input[name="interestLevel"]:checked')?.value || 'not-specified';

                let riskLevel = 'âœ… Safe';
                let finding = "Your electrical system appears healthy for your current needs.";
                let costRange = "Inspection/Minor Repair: ~$200-$1,500";
                let timeline = "1-3 days (inspection/minor repair)";

                // Prioritize severe issues
                if (panelBrand === 'federal-pacific' || panelBrand === 'challenger' || panelType === 'fuse') {
                    riskLevel = 'âŒ Urgent Upgrade';
                    finding = `Immediate panel replacement recommended due to hazardous brand (${panelBrand === 'fuse' ? 'outdated fuse box' : panelBrand}) for your Walnut Creek home.`;
                    costRange = "Panel Upgrade: ~$4,000-$12,000+ (depending on specific needs and appliance additions)";
                    timeline = "3-10 days (panel upgrade, considering permitting)";
                } else if (electricalIssues || selectedReasons.includes('tripping') || selectedReasons.includes('smells')) {
                    riskLevel = 'âš ï¸ Caution';
                    finding = "Warning signs indicate potential issues. Professional inspection is highly recommended.";
                    costRange = "Inspection/Minor Repair: ~$200-$1,500. Potentially Panel Upgrade: ~$4,000-$8,000";
                    timeline = "1-3 days (inspection/minor repair), up to 7 days for panel upgrade";
                } else if (amperage === '60') {
                    riskLevel = 'âš ï¸ Caution';
                    finding = "60 Amp service is insufficient for modern Walnut Creek homes. An upgrade is highly recommended.";
                    costRange = "Panel Upgrade: ~$4,000-$8,000";
                    timeline = "3-7 days (panel upgrade)";
                } else if (amperage === '100' && (recentRemodels || selectedReasons.includes('remodel') || selectedReasons.includes('ev') || selectedReasons.includes('solar'))) {
                    riskLevel = 'âš ï¸ Caution';
                    finding = "100 Amp service may be strained by recent remodels or planned additions (like EV charging, solar). Consider an upgrade for future needs.";
                    costRange = "Panel Upgrade: ~$4,000-$10,000+ (especially for EV/solar readiness)";
                    timeline = "3-7 days (panel upgrade)";
                }

                // Adjust cost/finding for specific new appliances if no critical existing issue
                if (riskLevel !== 'âŒ Urgent Upgrade') {
                    if (selectedAppliances.includes('ev') && parseInt(amperage) < 200) {
                        riskLevel = riskLevel === 'âœ… Safe' ? 'âš ï¸ Caution' : riskLevel;
                        finding = (finding === "Your electrical system appears healthy for your current needs." ? "" : finding + " Also, ") + "Adding an EV charger will likely require a service upgrade to at least 200 Amps for optimal performance.";
                        costRange = "Panel Upgrade (200 Amp): ~$6,000-$12,000+ (includes EV circuit)";
                        timeline = "3-10 days (panel upgrade)";
                    } else if (selectedAppliances.length > 0) {
                         riskLevel = riskLevel === 'âœ… Safe' ? 'âš ï¸ Caution' : riskLevel;
                         finding = (finding === "Your electrical system appears healthy for your current needs." ? "" : finding + " Additionally, ") + `Large appliances like ${selectedAppliances.map(a => a.replace('-', ' ')).join(', ')} may strain older panels.`;
                         costRange = "Inspection/Minor Upgrade: ~$500-$3,000. Potential Panel Upgrade: ~$4,000-$8,000";
                         timeline = "1-7 days";
                    }
                }


                electricalResultsHeadline.textContent = `Walnut Creek Electrical Health: ${riskLevel} Status!`;
                electricalKeyFinding.textContent = finding;
                electricalCostTimeline.textContent = `Estimated Cost: ${costRange}. Typical Timeline: ${timeline}.`;
                electricalWalnutCreekTip.textContent = "Walnut Creek permits apply for most electrical panel upgrades and new circuit installations. Bay Area Panels handles compliance. A free inspection is highly recommended for an exact quote, safety assessment, and to discuss EV/Solar readiness for your Walnut Creek home.";
                
                // Set hidden field value for lead capture
                electricalEstimatedResultHidden.value = electricalResultsHeadline.textContent + " | " + electricalKeyFinding.textContent + " | " + electricalCostTimeline.textContent;

                updateStepVisibility('electrical', 2);
            });

            getElectricalQuoteButton.addEventListener('click', () => {
                updateStepVisibility('electrical', 3);
            });

            electricalLeadCaptureForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const form = e.target;
                const formData = new FormData(form);
                
                try {
                    const response = await fetch(form.action, {
                        method: form.method,
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        showMessage("Thank you! Your request has been sent to Bay Area Panels. They will contact you shortly to schedule your free electrical inspection.");
                        setTimeout(() => { modals.electrical.classList.remove('show'); resetCalculatorState('electrical'); }, 3500);
                    } else {
                        const data = await response.json();
                        if (data.errors) {
                            showMessage('Submission Failed: ' + data.errors.map(error => error.message).join(', ') + '. Please try again.');
                        } else {
                            showMessage('Something went wrong with the submission. Please try again later.');
                        }
                    }
                } catch (error) {
                    console.error('Error submitting form:', error);
                    showMessage('Network error. Please check your internet connection and try again.');
                }
            });

            // --- KITCHEN REMODEL CALCULATOR LOGIC ---
            calculateKitchenButton.addEventListener('click', () => {
                const size = document.getElementById('kitchenSize').value;
                const finish = document.getElementById('kitchenFinish').value;
                const countertop = document.getElementById('countertopMaterial').value;
                const appliances = document.getElementById('newAppliances').value;

                let costMin = 0;
                let costMax = 0;
                let finding = "Estimated cost for your kitchen remodel.";
                let timeline = "6-12 weeks";

                // Base costs
                if (size === 'small') { costMin += 25000; costMax += 50000; }
                else if (size === 'medium') { costMin += 50000; costMax += 100000; }
                else if (size === 'large') { costMin += 100000; costMax += 180000; }

                // Finish level adjustment
                if (finish === 'mid-range') { costMin *= 1.2; costMax *= 1.5; }
                else if (finish === 'luxury') { costMin *= 1.8; costMax *= 2.5; }

                // Countertop adjustment
                if (countertop === 'quartz-granite') { costMin += 3000; costMax += 8000; }
                else if (countertop === 'marble') { costMin += 8000; costMax += 15000; }

                // Appliances adjustment
                if (appliances === 'mid-range') { costMin += 5000; costMax += 10000; }
                else if (appliances === 'high-end') { costMin += 10000; costMax += 25000; }

                // Round to nearest hundred for simplicity
                costMin = Math.round(costMin / 1000) * 1000;
                costMax = Math.round(costMax / 1000) * 1000;


                kitchenResultsHeadline.textContent = `Your Kitchen Remodel Estimate!`;
                kitchenKeyFinding.textContent = finding;
                kitchenCostTimeline.textContent = `Estimated Cost: $${costMin.toLocaleString()}-$${costMax.toLocaleString()}. Typical Timeline: ${timeline}.`;
                kitchenWalnutCreekTip.textContent = "High-end kitchen remodels can be more costly in Walnut Creek due to demand and material quality. Major kitchen remodels often require electrical panel upgrades, especially with new high-draw appliances.";

                // Set hidden field value for lead capture
                kitchenEstimatedResultHidden.value = kitchenResultsHeadline.textContent + " | " + kitchenKeyFinding.textContent + " | " + kitchenCostTimeline.textContent;

                updateStepVisibility('kitchen', 2);
            });

            getKitchenQuoteButton.addEventListener('click', () => {
                updateStepVisibility('kitchen', 3);
            });

            kitchenLeadCaptureForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const form = e.target;
                const formData = new FormData(form);

                try {
                    const response = await fetch(form.action, {
                        method: form.method,
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        showMessage("Thank you! Your kitchen remodel request has been sent to our experts.");
                        setTimeout(() => { modals.kitchen.classList.remove('show'); resetCalculatorState('kitchen'); }, 3500);
                    } else {
                        const data = await response.json();
                        if (data.errors) {
                            showMessage('Submission Failed: ' + data.errors.map(error => error.message).join(', ') + '. Please try again.');
                        } else {
                            showMessage('Something went wrong with the submission. Please try again later.');
                        }
                    }
                } catch (error) {
                    console.error('Error submitting form:', error);
                    showMessage('Network error. Please check your internet connection and try again.');
                }
            });

            // --- LANDSCAPE DESIGN CALCULATOR LOGIC ---
            calculateLandscapeButton.addEventListener('click', () => {
                const yardSize = parseInt(document.getElementById('yardSize').value);
                const style = document.getElementById('landscapeStyle').value;
                const featurePatioDeck = document.getElementById('featurePatioDeck').checked;
                const featureOutdoorLighting = document.getElementById('featureOutdoorLighting').checked;
                const featureIrrigation = document.getElementById('featureIrrigation').checked;
                const featureOutdoorKitchen = document.getElementById('featureOutdoorKitchen').checked;

                let costPerSqFtMin = 15;
                let costPerSqFtMax = 30;
                let additionalCost = 0;
                let finding = "Estimated cost for your outdoor oasis.";
                let timeline = "4-12 weeks";

                // Adjust for style (simplified)
                if (style === 'drought-tolerant') { /* slightly lower cost/sqft often */ }
                else if (style === 'traditional') { /* slightly higher cost/sqft often */ }

                // Feature costs
                if (featurePatioDeck) additionalCost += 5000 + (yardSize * 0.05); // Base + per sq ft
                if (featureOutdoorLighting) additionalCost += 2000;
                if (featureIrrigation) additionalCost += 3000;
                if (featureOutdoorKitchen) additionalCost += 8000;

                let totalCostMin = (yardSize * costPerSqFtMin) + additionalCost;
                let totalCostMax = (yardSize * costPerSqFtMax) + additionalCost;

                totalCostMin = Math.round(totalCostMin / 1000) * 1000;
                totalCostMax = Math.round(totalCostMax / 1000) * 1000;

                landscapeResultsHeadline.textContent = `Your Landscape Design Estimate!`;
                landscapeKeyFinding.textContent = finding;
                landscapeCostTimeline.textContent = `Estimated Cost: $${totalCostMin.toLocaleString()}-$${totalCostMax.toLocaleString()}. Typical Timeline: ${timeline}.`;
                landscapeWalnutCreekTip.textContent = "Walnut Creek properties benefit from fire-resistant landscaping and smart irrigation due to local regulations and climate. Water-wise gardening is key here. Larger projects, or those impacting drainage, may require a Site Development Permit from the City of Walnut Creek.";

                // Set hidden field value for lead capture
                landscapeEstimatedResultHidden.value = landscapeResultsHeadline.textContent + " | " + landscapeKeyFinding.textContent + " | " + landscapeCostTimeline.textContent;

                updateStepVisibility('landscape', 2);
            });

            getLandscapeQuoteButton.addEventListener('click', () => {
                updateStepVisibility('landscape', 3);
            });

            landscapeLeadCaptureForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const form = e.target;
                const formData = new FormData(form);

                try {
                    const response = await fetch(form.action, {
                        method: form.method,
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        showMessage("Thank you! Your landscaping request has been sent to our experts.");
                        setTimeout(() => { modals.landscape.classList.remove('show'); resetCalculatorState('landscape'); }, 3500);
                    } else {
                        const data = await response.json();
                        if (data.errors) {
                            showMessage('Submission Failed: ' + data.errors.map(error => error.message).join(', ') + '. Please try again.');
                        } else {
                            showMessage('Something went wrong with the submission. Please try again later.');
                        }
                    }
                } catch (error) {
                    console.error('Error submitting form:', error);
                    showMessage('Network error. Please check your internet connection and try again.');
                }
            });

            // --- ADU EXPANSION COST CALCULATOR LOGIC (NEW) ---
            const aduCosts = {
                baseCostPerSqFt: { min: 450, max: 700 },
                aduTypeMultiplier: {
                    "Attached Addition": { min: 1.0, max: 1.1 },
                    "Garage Conversion": { min: 0.9, max: 1.05 },
                    "Junior ADU": { min: 0.95, max: 1.05 },
                    "Detached ADU": {min: 1.1, max: 1.3}
                },
                finishLevelMultiplier: {
                    "Basic": { min: 0.8, max: 0.95 },
                    "Mid-Range": { min: 1.0, max: 1.15 },
                    "High-End": { min: 1.2, max: 1.5 }
                },
                siteChallengeCosts: {
                    "Sloped Lot": { min: 20000, max: 60000 },
                    "Limited Access": { min: 10000, max: 30000 },
                    "Extensive Utility Runs": { min: 8000, max: 25000 },
                    "Drainage Issues": { min: 5000, max: 20000 }
                },
                additionalFeatureCosts: {
                    "Extra Bathroom": { min: 25000, max: 50000 },
                    "Laundry": { min: 7000, max: 18000 },
                    "Deck/Patio": { min: 10000, max: 30000 },
                    "Solar Panels": { min: 15000, max: 35000 },
                    "HighEfficiencyHVAC": { min: 8000, max: 20000 }
                },
                permitSoftCostPercentage: { min: 0.15, max: 0.25 }
            };

            calculateAduCostBtn.addEventListener('click', () => {
                const aduType = aduTypeSelect.value;
                const squareFootage = parseFloat(squareFootageInput.value);
                const finishLevel = finishLevelSelect.value;

                if (isNaN(squareFootage) || squareFootage <= 0) {
                    showMessage('Please enter a valid positive number for square footage.');
                    aduResults.classList.add('hidden'); // Hide results if input is invalid
                    return;
                }

                let totalConstructionCostMin = 0;
                let totalConstructionCostMax = 0;

                const baseSqFtCostMin = aduCosts.baseCostPerSqFt.min;
                const baseSqFtCostMax = aduCosts.baseCostPerSqFt.max;

                const finishMultMin = aduCosts.finishLevelMultiplier[finishLevel].min;
                const finishMultMax = aduCosts.finishLevelMultiplier[finishLevel].max;

                const aduTypeMultMin = aduCosts.aduTypeMultiplier[aduType].min;
                const aduTypeMultMax = aduCosts.aduTypeMultiplier[aduType].max;

                const sqFtConstructionMin = squareFootage * baseSqFtCostMin * finishMultMin * aduTypeMultMin;
                const sqFtConstructionMax = squareFootage * baseSqFtCostMax * finishMultMax * aduTypeMultMax;

                totalConstructionCostMin += sqFtConstructionMin;
                totalConstructionCostMax += sqFtConstructionMax;

                aduSiteChallengesCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        const challenge = checkbox.value;
                        totalConstructionCostMin += aduCosts.siteChallengeCosts[challenge].min;
                        totalConstructionCostMax += aduCosts.siteChallengeCosts[challenge].max;
                    }
                });

                aduAdditionalFeaturesCheckboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        const feature = checkbox.value;
                        totalConstructionCostMin += aduCosts.additionalFeatureCosts[feature].min;
                        totalConstructionCostMax += aduCosts.additionalFeatureCosts[feature].max;
                    }
                });

                const permitSoftMin = totalConstructionCostMin * aduCosts.permitSoftCostPercentage.min;
                const permitSoftMax = totalConstructionCostMax * aduCosts.permitSoftCostPercentage.max;

                const finalCostMin = totalConstructionCostMin + permitSoftMin;
                const finalCostMax = totalConstructionCostMax + permitSoftMax;

                const avgPricePerSqFtMin = finalCostMin / squareFootage;
                const avgPricePerSqFtMax = finalCostMax / squareFootage;

                aduCostRange.textContent = `${formatCurrency(finalCostMin)} - ${formatCurrency(finalCostMax)}`;
                aduAvgPriceSqFt.textContent = `${formatCurrency(avgPricePerSqFtMin)} - ${formatCurrency(avgPricePerSqFtMax)}`;
                aduTimeline.textContent = `Approximately 8-20 weeks for construction (does not include design/permitting phase which can be 4-12 weeks)`;
                aduPermitSoftCosts.textContent = `${formatCurrency(permitSoftMin)} - ${formatCurrency(permitSoftMax)}`;

                aduEstimatedResultHidden.value = `Cost: ${aduCostRange.textContent} | Avg Price/SqFt: ${aduAvgPriceSqFt.textContent} | Timeline: ${aduTimeline.textContent} | Permits: ${aduPermitSoftCosts.textContent}`;

                aduResults.classList.remove('hidden'); // Show results section
                
                // Show ADU lead capture form after calculation
                updateStepVisibility('adu', 2); // Move to the lead capture "step"
            });
            
            aduLeadCaptureForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const form = e.target;
                const formData = new FormData(form);

                try {
                    const response = await fetch(form.action, {
                        method: form.method,
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });

                    if (response.ok) {
                        showMessage("Thank you! Your ADU expansion request has been sent to our experts.");
                        setTimeout(() => { modals.adu.classList.remove('show'); resetCalculatorState('adu'); }, 3500);
                    } else {
                        const data = await response.json();
                        if (data.errors) {
                            showMessage('Submission Failed: ' + data.errors.map(error => error.message).join(', ') + '. Please try again.');
                        } else {
                            showMessage('Something went wrong with the submission. Please try again later.');
                        }
                    }
                } catch (error) {
                    console.error('Error submitting form:', error);
                    showMessage('Network error. Please check your internet connection and try again.');
                }
            });

            // Initial setup when page loads: ensure all modals are hidden and calculators reset
            Object.keys(modals).forEach(type => {
                resetCalculatorState(type);
            });
        });
    </script>
</body>
</html>
